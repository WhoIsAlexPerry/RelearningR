---
title: "Chap 1 - Data Visualization"
author: "Alex Perry"
date: "2026-02-04"
output: html_document
---

#1.1 Introduction

GGPlot - grammar of graphics, will use ggplot2 in this textbook. 

#1.1.1 Prerequisites

```{r}
library(tidyverse)
```

This contains packages used in data analysis. Need to load each time I start a new session. 

For data, we'll use the Palmer Penguins package, which contains body measurements for penguins on three islands and the ggthemes package (colorblind safe)

```{r}
library(palmerpenguins)
```

#1.2 First steps
Use the penguins data set to answer the questions in the textbook. 

#1.2.1 The penguins data frame
A data frame is a rectangular collection of variables (in columns) and observations (in rows). Variables are measurable features. Values are the state of the variable when you measure it. 

Observations are the set of measurements made under similar conditions for one unit. 

Tabular data: set of values, each associated with a variable and an observation. This is tidy if each value is placed in its own cell. 

In the penguin context, a variable refers to an attribute of all the penguins. An observations refers to all the attributes of a single penguin. 

```{r}
penguins
glimpse(penguins)
View(penguins)
```
Among the variables are species, flipper length, body mass. 

#1.2.2 Ultimate Goal 
Recreate a visualization from the textbook. 

#1.2.3 Creating a ggplot

With ggplot, beging with the function ggplot(). This defines a plot object to add layers to. The first argument of the plot is the dataset. i.e. ggplot(data = penguins)

```{r}
ggplot(data = penguins)
```
Next, we need to deal with the mapping argument. This defines how variables in the plot are mapped to visual properties (aesthetics)

Mapping is always defined by the aesthetics argument, aes(). The X and Y arguments specify which variables to map to which axes. 

Below, we'll map flipper length to x and body mass to y. 

```{r}
ggplot(
  data = penguins,
  mapping = aes(x = flipper_len, 
                y = body_mass))
```
Canvas now has structure, but we haven't articulated how to represent the observations on the plot. 

Now, we need a GEOM. Geometrical object that a plot uses to represent data. THese functions start with geom_. 

Here, we describe the type of geom that the plot uses. Bar charts are geom_bar(), line charts use geom_line(), boxplots use geom_boxplot() and scatterplots use geom_point(). 

The function geom_point() adds a layer of points that create a scatterplot. 

```{r}
ggplot(
  data = penguins, 
  mapping = aes(
    x = flipper_len,
    y = body_mass
  )
) +
  geom_point()
```
As flipper length increases, body mass does as well. The trend is also linear and strong.  The warning message showed up because two values were missing. 

#1.2.4 Adding aesthetics and layers 
We should ask if this trend different by species. 
```{r}
ggplot(
  data = penguins,
  mapping = aes(x = flipper_len, y = body_mass, color = species)
) +
  geom_point()
```
Scaling is the automatic process ggplot2 uses to map a nique value of the aesthetic. The program will also add a legend. Also, add a layer displaying a smooth curve depicting the relationship between body mass and flipper length. 

To do this, we will add a new geom as a layer on top of the points geom called geom_smooth(). The linear model fit we'll use is called method = "lm". 

```{r}
ggplot(
  data = penguins,
  mapping = aes(x = flipper_len,
                y = body_mass,
                color = species)
) +
  geom_point() + 
  geom_smooth(method = "lm")
```
This is wrong because we want the Loess line at the global level, not local level. 
If we want them to share the line, we should specify the color mapping under the points part. 

```{r}
ggplot(
  data = penguins, 
  mapping = aes(x = flipper_len,
                y = body_mass)
) +
  geom_point(mapping = aes(color = species)) +
  geom_smooth(method = "lm")
```
Now, we should add labels using the labs() argument. Title, subtitle fall into this category. x is the x-axis label, y is the y-axis label, and color and shape define the label for the legend. In addition, we can improve the color palette to be colorblind safe with the scale_color_colorblind() 


```{r}
ggplot(
  data = penguins, 
  mapping = aes(
    x = flipper_len,
    y = body_mass
  )
) +
  geom_point(aes(color = species, shape = species)) +
  geom_smooth(method = "lm") +
  labs(
    title = "Body mass and flipper length",
    subtitle = "Dimensions for Adelie, Chinstrap, and Gentoo Penguins", x = "Flipper length (mm)", y = "Body mass (g)",
    color = "Species", shape = "Species"
  ) 
```
The colorblind function doesn't work.

#1.2.5 Exercises

1. How many rows are in penguins? How many columns?

```{r}
glimpse(penguins)
```
344 rows, 8 columns. 

2. What does the bill_depth_mm variable in the penguins data frame describe? Read the help for ?penguins to find out.

```{r}
help(penguins)
```
A number denoting bill depth (millimeters)


3. Make a scatterplot of bill_depth_mm vs. bill_length_mm. That is, make a scatterplot with bill_depth_mm on the y-axis and bill_length_mm on the x-axis. Describe the relationship between these two variables.

```{r}
ggplot(data = penguins,
       mapping = aes(x = bill_length_mm,
                     y = bill_depth_mm)) + geom_point()
```
There are two clusters of data on the graph. There's no linear relationship, but there are clear minimums for each variable.

4. What happens if you make a scatterplot of species vs. bill_depth_mm? What might be a better choice of geom?

```{r}
ggplot(
  data = penguins,
  mapping = aes(
    x = species,
    y = bill_depth_mm
  )) + geom_point()
```
Box plot might be better.
```{r}
ggplot(
  data = penguins,
  mapping = aes(
    x = species,
    y = bill_depth_mm
  )) + geom_boxplot()
```


5. Why does the following give an error and how would you fix it?

ggplot(data = penguins) + 
  geom_point()

The following gives an error because the variables are not mapped well. There's not X or Y. Here's a fixed version.

6. What does the na.rm argument do in geom_point()? What is the default value of the argument? Create a scatterplot where you successfully use this argument set to TRUE.

The argument ignores empty values. 

```{r}
ggplot(data = penguins,
       mapping = aes(
         x = bill_length_mm,
         y = bill_depth_mm
       )) + geom_point(na.rm = TRUE)
```

7. Add the following caption to the plot you made in the previous exercise: “Data come from the palmerpenguins package.” Hint: Take a look at the documentation for labs().

```{r}
ggplot(data = penguins,
       mapping = aes(
         x = bill_length_mm,
         y = bill_depth_mm
       )) + geom_point(na.rm = TRUE) + labs(caption = "Data come from the palmerpenguins package.")
```
8. Recreate the following visualization. What aesthetic should bill_depth_mm be mapped to? And should it be mapped at the global level or at the geom level?

Mapped to the global level!

```{r}
ggplot(data = penguins,
       mapping = aes(
         x = flipper_length_mm,
         y = body_mass_g, 
         color = bill_depth_mm
       )) +
         geom_point() + geom_smooth()
```

9. Run this code in your head and predict what the output will look like. Then, run the code in R and check your predictions.

ggplot(
  data = penguins,
  mapping = aes(x = flipper_length_mm, y = body_mass_g, color = island)
) +
  geom_point() +
  geom_smooth(se = FALSE)
  
  It'll be a scatterplot where the different dots will denote what island the penguins are from. 
  
```{r}
ggplot(
  data = penguins,
  mapping = aes(x = flipper_length_mm, y = body_mass_g, color = island)
) +
  geom_point() +
  geom_smooth(se = FALSE)
```
  
The geom-smooth line is at the global level. 

10. Will these two graphs look different? Why/why not?

ggplot(
  data = penguins,
  mapping = aes(x = flipper_length_mm, y = body_mass_g)
) +
  geom_point() +
  geom_smooth()

ggplot() +
  geom_point(
    data = penguins,
    mapping = aes(x = flipper_length_mm, y = body_mass_g)
  ) +
  geom_smooth(
    data = penguins,
    mapping = aes(x = flipper_length_mm, y = body_mass_g)
  )
  
  They'll look the same.
  
```{r}
ggplot(
  data = penguins,
  mapping = aes(x = flipper_length_mm, y = body_mass_g)
) +
  geom_point() +
  geom_smooth()

ggplot() +
  geom_point(
    data = penguins,
    mapping = aes(x = flipper_length_mm, y = body_mass_g)
  ) +
  geom_smooth(
    data = penguins,
    mapping = aes(x = flipper_length_mm, y = body_mass_g)
  )
```
  
#1.3 ggplot2 calls 

Rewriting code concisely! 

ggplot(
  data = penguins,
  mapping = aes(x = flipper_length_mm, y = body_mass_g)
) +
  geom_point()
  
  is also 
  
  ggplot(penguins, aes(x = flipper_length_mm, y = body_mass_g)) + 
  geom_point()


